{
    "contents" : "#################################################################\n#Grafik Option\n#################################################################\nplotting <- function(nf, fac_names, n.hypotheses,\n                     Descriptive.Factors, CI.method, ...){\n\n\n  if(nf ==1){\n    Faktor = fac_names[1]}\n  \n  if(nf > 1){\n    print(\"Please choose the factor you wish to plot (for interaction type something like group1:group2) and confirm by pressing 'Enter'\")\n    Faktor <- scan(\"\", what = \"character\")      \n  }\n  \n  Fak.split <- strsplit(Faktor,\":\")[[1]]\n  l.Fak.split <- length(Fak.split)\n  \n  \n  if (!(Faktor %in% fac_names)) {\n    stop(\"Please enter a valid factor name!\")\n  }\n  \n  \n  for(i in 1:n.hypotheses){\n    \n    if(names(Descriptive.Factors)[i] == Faktor){\n      posP <- which(names(Descriptive.Factors)[i] == Faktor)\n      DatenPlot <- data.frame(Descriptive.Factors[[i]])\n      \n      \n      switch(CI.method, Logit={\n        upper = DatenPlot$U.Logit \n        lower = DatenPlot$L.Logit},\n        Normal={\n          upper =DatenPlot$U.Normal\n          lower = DatenPlot$L.Normal})\n      \n      \n      if (l.Fak.split==1){\n        print(xyplot(pd ~ DatenPlot[,1], group=DatenPlot[,1],data = DatenPlot, \n                     type = 'p',xlab=paste(names(DatenPlot[1])),\n                     col = 1, pch = 7, cex = 1.3, ylim = c(0, 1),\n                     ylab=\"\",upper = upper,\n                     lower = lower,\n                     panel = function(x, y, ...){\n                     panel.superpose(x, y,panel.groups = function(x, y, upper, lower,subscripts, ..., font, fontface) {\n                       upper <- upper[subscripts]\n                       lower <- lower[subscripts]\n                       panel.arrows(x, lower, x, upper,code=4,lwd=4)   \n                       panel.points(x, lower,pch=\"_\",cex=3,lwd=4,col=1)\n                       panel.points(x, upper,pch=\"_\",cex=3,lwd=4,col=1)\n                     } , ...)\n                       panel.xyplot(x, y, ...)}))}\n      \n      if (l.Fak.split==2){\n        print(xyplot(pd ~ DatenPlot[,1]|DatenPlot[,2], \n                     group=DatenPlot[,1],data = DatenPlot, type = 'p',\n                     xlab=paste(names(DatenPlot[1])),\n                     col = 1, pch = 7, cex = 1.3, ylim = c(0, 1),\n                     upper = upper,\n                     lower = lower,\n                     panel = function(x, y, ...){\n                       panel.superpose(x, y,panel.groups = function(x, y, upper, lower,subscripts, ..., font, fontface) {\n                         upper <- upper[subscripts]\n                         lower <- lower[subscripts]\n                         panel.arrows(x, lower, x, upper,code=4,lwd=4)   \n                         panel.points(x, lower,pch=\"_\",cex=3,lwd=4,col=1)\n                         panel.points(x, upper,pch=\"_\",cex=3,lwd=4,col=1)\n                       }, ...)\n                       panel.xyplot(x, y, ...)\n                     }))\n        \n      }\n      \n      \n      if (l.Fak.split==3){\n        print(xyplot(pd ~ DatenPlot[,1]|DatenPlot[,2]*DatenPlot[,3], \n                     group=DatenPlot[,1],data = DatenPlot, type = 'p',\n                     xlab=paste(names(DatenPlot[1])),\n                     col = 1, pch = 7, cex = 1.3, ylim = c(0, 1),\n                     upper = upper,\n                     lower = lower,\n                     panel = function(x, y, ...){\n                       panel.superpose(x, y,panel.groups = function(x, y, upper, lower,subscripts, ..., font, fontface) {\n                         upper <- upper[subscripts]\n                         lower <- lower[subscripts]\n                         panel.arrows(x, lower, x, upper,code=4,lwd=4)   \n                         panel.points(x, lower,pch=\"_\",cex=3,lwd=4,col=1)\n                         panel.points(x, upper,pch=\"_\",cex=3,lwd=4,col=1)\n                       }, ...)\n                       panel.xyplot(x, y, ...)\n                     }))\n        \n      }\n      \n      if (l.Fak.split>=4){\n        stop(\"4 and higher way interactions cannot be plotted!\")\n      }\n    }}\n}",
    "created" : 1461739733148.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2327992207",
    "id" : "5A12234A",
    "lastKnownWriteTime" : 1461827982,
    "path" : "~/Dropbox/rankFD/rankFD/R/plot_options.R",
    "project_path" : "R/plot_options.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}